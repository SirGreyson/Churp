<link rel="imoport" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/iron-form/iron-form.html">
<link rel="import" href="../bower_components/paper-input/paper-input.html">
<link rel="import" href="../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="../bower_components/paper-button/paper-button.html">
<script src="../bower_components/firebase/firebase.js"></script>
<script src="../js/firebase.js"></script>
<link rel="import" href="../bower_components/iron-collapse/iron-collapse.html">

<dom-module id="settings-module">
    
    
    <style>
        #form {
            margin: auto;
            width: 60%;
            height: 25em;
            min-width: 25em;
            min-height: 20em;
            border: 0 solid lightgrey;
            padding: 2em;
            overflow: hidden;
            box-shadow: 0px 0px 20px 1px lightgray;
            text-align: center;
            background-color:rgba(991,991,991,1);
        }
        paper-input {
            text-align: left;
        }

        iron-icon {
            margin-right: .5em;
        }
        
        #spinner {
            margin-top: 0em;
        }
        
        #alert-area {
            color: black;
            margin-top: 0.5em;
        }

        paper-button {
            margin: 0.3em auto;
            width: auto;
            letter-spacing: 0.5em;
            border: 1px solid black;
            border-radius: 0;
        }
        
        #payment-container {
            width: 100%;
        }
        #password-container {
            width: 100%;
        }
        #phone-container {
            width: 100%;
        }
    </style>

    <template>
        <form is="iron-form" id="form">
        <paper-button id="payment-container" on-click="togglePayment">PAYMENT SETTINGS
            <br>
            <iron-icon icon="expand-more"></iron-icon>
            <iron-collapse id="payments">
                <div>Content goes here...</div>
            </iron-collapse>
        </paper-button>
                <paper-button id="password-container" on-click="togglePassword">CHANGE PASSWORD
            <br>
            <iron-icon icon="expand-more"></iron-icon>
            <iron-collapse id="password">
                <div>Content goes here...</div>
            </iron-collapse>
        </paper-button>
                <paper-button id="phone-container" on-click="togglePhone">PHONE SETTINGS
            <br>
            <iron-icon icon="expand-more"></iron-icon>
            <iron-collapse id="phone">
                <div>Content goes here...</div>
            </iron-collapse>
        </paper-button>

        </form>
    </template>

    <script>
        Polymer({
            is: 'settings-module',
            togglePayment: function() {
                this.$.payments.toggle();
            },
            togglePassword: function() {
                this.$.password.toggle();
            },
            togglePhone: function() {
                this.$.phone.toggle();
            },

            submitForm: function () {
                userExists(this.username, this).then(function (success) {
                    document.getElementById('username').invalid = !success.value;
                    if (!success.value) {
                        document.getElementById('password').invalid = false;
                        document.getElementById('password').value = '';
                    }
                });
                authorizeUser(this.username, this.password).then(function (success) {
                    document.getElementById('password').invalid = !success;
                    if (success) {
                        //TODO Navigate to user's setting page
                    }
                });
            }
        });
    </script>

</dom-module>